<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>管理后台</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <!-- Favicon -->
    <link rel="shortcut icon" href="__PUBLIC__/static/img/favicon.ico" type="image/x-icon">
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="__PUBLIC__/static/plugins/bootstrap/css/bootstrap.min.css">

    <!-- CSS Animate -->
    <link rel="stylesheet" href="__PUBLIC__/static/css/animate.css">
    <!-- Custom styles for this theme -->
    <link rel="stylesheet" href="__PUBLIC__/static/css/main.css">
    <!-- iCheck-->
    <link rel="stylesheet" href="__PUBLIC__/static/plugins/icheck/css/_all.css">

    <link rel="stylesheet" href="__PUBLIC__/static/css/chosen.css">

    <link href="__PUBLIC__/umeditor122/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">

    <link rel="stylesheet" href="__PUBLIC__/static/css/jquery.fileupload.css">
    <script src="http://libs.baidu.com/jquery/1.11.1/jquery.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor122/umeditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="__PUBLIC__/umeditor122/umeditor.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/umeditor122/lang/zh-cn/zh-cn.js"></script>

</head>

<body>
    <section id="container">
       <include file="Public/header" />
        <!--sidebar start-->
         <include file="Public/lefter" />
        <!--sidebar end-->
        <!--main content start-->
        <section class="main-content-wrapper">
            <section id="main-content">
                <div class="row">
                    <div class="col-md-12">
                        <!--breadcrumbs start -->
                        <ul class="breadcrumb">
                            <li><a href="#">Dashboard</a>
                            </li>
                            <li>Forms</li>
                            <li class="active">Form Components</li>
                        </ul>
                        <!--breadcrumbs end -->

                    </div>
                </div>
                 <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">

                          <div class="panel-body">

                                <a href="__CONTROLLER__/index" class="btn btn-primary">文章列表</a>
                                <a href="__CONTROLLER__/create"  class="btn btn-info">添加文章</a>



                            </div>
                        </div>
                    </div>
                </div>
       <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">添加</h3>
                                <div class="actions pull-right">
                                    <i class="fa fa-chevron-down"></i>
                                    <i class="fa fa-times"></i>
                                </div>
                            </div>
                            <div class="panel-body">
                                <form class="form-horizontal form-border" action="__CONTROLLER__/store" enctype="multipart/form-data" method="post" id="form1">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">标题</label>
                                        <div class="col-sm-6">
                                            <input type="text" name="title"  required class="form-control">
                                        </div>
                                    </div>



                                      <div class="form-group">
                                        <label class="col-sm-3 control-label">所属分类</label>
                                        <div class="col-sm-6">
                                            <select data-placeholder="选择上级分类" class="chosen-select" name="category_id">
                                               <option value="0">顶级分类</option>
                                               <volist name="catelist" id="vo">
                                                    <option value="{$vo.id}">{$vo.cname}</option>
                                                </volist>
                                              </select>

                                        </div>
                                    </div>

<!-- Style here -->
<style>
.thumb-list .temp { border:#DDD dashed 1px; text-align:center; position:relative; overflow:hidden; }
.thumb-list .temp a { display:inline-block; width:100%; height:100%; color:#CCC; }
.thumb-list .icon { display:inline-block; font-style:normal; width:100%; font-size:33px; margin-top:20px; margin-bottom:10px; }
.thumb-list .img-thumbnail { vertical-align:top; margin-right:10px; }
.thumb-list .img-thumbnail img { width:100%; height:100%; }
</style>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label" >缩略图</label>
                                        <div class="col-sm-6 thumb-list">

                                            <span class="temp img-thumbnail" style="width:140px; height:140px;">
                                                <a id="upload" href="javascript:;">
                                                    <em class="glyphicon glyphicon-plus icon"></em>
                                                    添加图片
                                                </a>
                                            </span>

                                        </div>
                                    </div>



                                    <div class="form-group">
                                        <label class="col-sm-3 control-label" >排序</label>
                                        <div class="col-sm-6">
                                            <input type="text" name="weight" class="form-control" value="50">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label" >报价</label>
                                        <div class="col-sm-6">
                                            <input type="text" name="price" class="form-control" value="">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                            <label class="col-sm-3 control-label">内容</label>
                                            <div class="col-sm-6">
                                                <!--style给定宽度可以影响编辑器的最终宽度-->
                                                <script type="text/plain" name="content" id="editor" style="width:800px;height:200px"></script>

                                            </div>
                                    </div>
                                    <div class="form-group">
                                            <label class="col-sm-3 control-label">费用信息</label>
                                            <div class="col-sm-6">
                                                <!--style给定宽度可以影响编辑器的最终宽度-->
                                                <script type="text/plain" name="fee_info" id="fee" style="width:800px;height:200px"></script>

                                            </div>
                                    </div>

                                    <div class="form-group">
                                            <label class="col-sm-3 control-label">路线信息</label>
                                            <div class="col-sm-6">
                                                <!--style给定宽度可以影响编辑器的最终宽度-->
                                                <script type="text/plain" name="route_info" id="route" style="width:800px;height:200px"></script>

                                            </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-6">

                                        <input type="submit" value="提交"  class="btn btn-primary btn-square">
                                        </div>
                                    </div>
                                </form>


                            </div>
                        </div>
                    </div>
                </div>








            </section>
        </section>
        <!--main content end-->

    </section>
    <!--Global JS-->

    <script src="__PUBLIC__/static/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="__PUBLIC__/static/plugins/waypoints/waypoints.min.js"></script>
    <script src="__PUBLIC__/static/js/application.js"></script>
    <script src="__PUBLIC__/static/plugins/chosen.jquery.js" type="text/javascript" ></script>
    <script src="__PUBLIC__/static/plugins/plupload.full.min.js" type="text/javascript" ></script>

    <script>
         //实例化编辑器
        UM.getEditor('editor');
        UM.getEditor('route');
        UM.getEditor('fee');

          //可以搜索的下拉插件
    var config = {
      '.chosen-select'           : {},
      '.chosen-select-deselect'  : {allow_single_deselect:true},
      '.chosen-select-no-single' : {disable_search_threshold:10},
      '.chosen-select-no-results': {no_results_text:'找不到哦...'},
      '.chosen-select-width'     : {width:"95%"}
    }

    for (var selector in config) {
      $(selector).chosen(config[selector]);
    }


    var uploader = new plupload.Uploader({
        runtimes : 'html5,flash,html4',
        browse_button : 'upload',
        url : "__CONTROLLER__/upload",
        //multipart_params : {type:"cover"},
        filters : {
            max_file_size : '2mb',
            mime_types: [{title : "Image files", extensions : "jpg,gif,png"}]
        },
        flash_swf_url : '__PUBLIC__/static/plugins/Moxie.swf',
        silverlight_xap_url : '__PUBLIC__/static/plugins/Moxie.xap',
        init: {
            Init: function(up) {
                return false;
            },

            FilesAdded: function(up, files) {
                plupload.each(files, function(file) {
                    $("#upload").parent().before("<span id=\"file-"+file.id+"\" class=\"img-thumbnail\" style=\"width: 140px; height: 140px;\"><img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9InllcyI/PjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQwIiBoZWlnaHQ9IjE0MCIgdmlld0JveD0iMCAwIDE0MCAxNDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjxkZWZzLz48cmVjdCB3aWR0aD0iMTQwIiBoZWlnaHQ9IjE0MCIgZmlsbD0iI0VFRUVFRSIvPjxnPjx0ZXh0IHg9IjM1IiB5PSI3MCIgc3R5bGU9ImZpbGw6I0FBQUFBQTtmb250LXdlaWdodDpib2xkO2ZvbnQtZmFtaWx5OkFyaWFsLCBIZWx2ZXRpY2EsIE9wZW4gU2Fucywgc2Fucy1zZXJpZiwgbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMHB0O2RvbWluYW50LWJhc2VsaW5lOmNlbnRyYWwiPlVwbG9hZGluZy4uPC90ZXh0PjwvZz48L3N2Zz4=\" /></span>");
                });
                up.start();
            },

            FileUploaded: function(up, file, res) {
                var data = $.parseJSON(res.response);
                if(!data.s){
                    var rs = data.rs;
                    var photo = $("#file-"+file.id+" img");
                    photo.attr("src", '__PUBLIC__/file/'+rs);
                }
            }
        }
    });

    uploader.init();


    </script>


</body>

</html>
